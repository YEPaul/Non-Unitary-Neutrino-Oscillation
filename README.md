The code is authored by Jianrong (Paul) Tang based on 
